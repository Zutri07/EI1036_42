 PDF To Markdown Converter
Debug View
Result View

##### Tema 6:

##### JSON

##### IFRAME/TEMPLATE

##### Ajax/Promise

##### SEguridad

**EI1036 EI
Dolores María Llidó Escrivá
Curso 2017 – 2018**


### Índice

1. Funciones Closures
    a. Problemas Closures
2. Gestión Eventos
3. AJAX
    a. API XMLHttpRequest
4. Función Flecha
5. Promise
6. CORS
7. Etiqueta SCRIPT
8. IFRAME
9. API GLOBALFETCH


#### 1. closure

● En JavaScript, el ámbito de una variable se define por su

```
ubicación dentro del código fuente y las funciones
anidadas tienen acceso a las variables declaradas en su
ámbito externo.
```
● Un **closure** permite que una función dentro de otra función

```
contenedora pueda hacer referencia a las variables después
de que la función contenedora ha terminado de ejecutarse.
```
```
3
```
```
function init() {
var name = "Mozilla";
function displayName() {alert(name);}
displayName();
}
init();
```

#### closure

● Los closures son funciones que manejan variables

```
independientes, la función definida en el closure
"recuerda" el entorno en el que se ha creado.
```
● REGLA:Toma el último valor de la variable de la función

```
contenedora.
Dentro de ciclos o loops se suelen producir errores por no
tener en cuenta esta regla.
function creaSumador(x) {
return function(y) {
return x + y;
```
(^) } };
var suma5 = creaSumador( 5 );
var suma10 = creaSumador( 10 );
consoleconsole..loglog((suma10suma5(^2 ()); 2 ));^ // muestra 7// muestra 12^


#### Ejemplos JavaScript(4)

## function llamaotra1 ( A ){

## console.log(A) ;

## }

## function llamaotra2 ( A ){

## console.log(eval ( A )); //ejecuta funcion

## }

## function funcionllamada ( B ){

## console.log(B) ;

**}**

## llamaotra1 ( funcionllamada ( "Estoy Aqui1" ));

## llamaotra1 ( 'funcionllamada("Estoy Aqui2")' );

## llamaotra2 ( 'funcionllamada("Estoy Aqui3")' );

**¿Que aparecerá en la pantalla?**


#### closure

● En JavaScript, el ámbito de una variable se define por su

```
ubicación dentro del código fuente y las funciones
anidadas tienen acceso a las variables declaradas en su
ámbito externo.
```
● Un **closure** permite que una función dentro de otra función

```
contenedora pueda hacer referencia a las variables después
de que la función contenedora ha terminado de ejecutarse.
```
```
6
```
```
function init() {
var name = "Mozilla";
function displayName() {alert(name);}
displayName();
}
init();
```

#### closure

● Los closures son funciones que manejan variables

```
independientes, la función definida en el closure
"recuerda" el entorno en el que se ha creado.
```
● REGLA:Toma el último valor de la variable de la función

```
contenedora.
Dentro de ciclos o loops se suelen producir errores por no
tener en cuenta esta regla.
function creaSumador(x) {
return function(y) {
return x + y;
```
(^) } };
var suma5 = creaSumador( 5 );
var suma10 = creaSumador( 10 );
consoleconsole..loglog((suma10suma5(^2 ()); 2 ));^ // muestra 7// muestra 12^


#### Ejemplos JavaScript(4)

## function llamaotra1 ( A ){

## console.log(A) ;

## }

## function llamaotra2 ( A ){

## console.log(eval ( A )); //ejecuta funcion

## }

## function funcionllamada ( B ){

## console.log(B) ;

**}**

## llamaotra1 ( funcionllamada ( "Estoy Aqui1" ));

## llamaotra1 ( 'funcionllamada("Estoy Aqui2")' );

## llamaotra2 ( 'funcionllamada("Estoy Aqui3")' );

**¿Que aparecerá en la pantalla?**


#### 1 a- Problema Closures

```
<p id="help">Helpful notes will appear here</p>
<p>E-mail: <input type="text" id="email" name="email"></p>
<p>Name: <input type="text" id="name" name="name"></p>
<p>Age: <input type="text" id="age" name="age"></p>
```
```
9
```
function showHelp(help) {
document.getElementById('help').innerHTML = help;
}
function setupHelp() {
var helpText = [
{'id': 'email', 'help': 'Dirección de correo electrónico'},
{'id': 'name', 'help': 'Nombre completo'},
{'id': 'age', 'help': 'Edad (debes tener más de 16 años)'} ];
for (var i = 0 ; i < helpText.length; i++) {
var item = helpText[i];
document.getElementById(item.id).addEventListener("focus",
function() { showHelp(item.help)});
}}
setupHelp();

```
http://jsfiddle.net/
https://codepen.io/idesi/pen/rLgaJO
```
```
¿Qué valor muestra en la ayuda al pulsar sobre Name?¿Por qué?
```

#### Problema Closures

**<p id="help">Helpful notes will appear here</p>
<p>E-mail: <input type="text" id="email" name="email"></p>
<p>Name: <input type="text" id="name" name="name"></p>
<p>Age: <input type="text" id="age" name="age"></p>**
function showHelp(help) {
return function(){
document.getElementById('help').innerHTML = help;};}
function setupHelp() {
var helpText = [
{'id': 'email', 'help': 'Dirección de correo electrónico'},
{'id': 'name', 'help': 'Nombre completo'},
{'id': 'age', 'help': 'Edad (debes tener más de 16 años)'} ];
for (var i = 0 ; i < helpText.length; i++) {
var item = helpText[i];
document.getElementById(item.id).addEventListener("focus",
showHelp(item.help));
}}
setupHelp();


#### 2.Gestión Eventos

★ **Capture** : Al realizar el cliente un evento,
el navegador sabe que se ha producido un
evento,y busca desde la raíz del DOM para
ver donde se ha producido. event object
★ **Target** : Una vez sabe en qué elemento se ha
producido el explorador comprueba si tiene
algún controlador en ese elemento, si existe
lo ejecuta. event target object
★ **Boobling** : Después de disparar el lanzador,
busca hacia la raíz, si en los niveles padre
del elemento hay algún otro controlador que
se active con ese evento, en su caso lo
lanzará. Esta etapa de su movimiento hacia

arriba se llama la propagación de eventos (^) [http://www.thatjsdude.com/images/eventBubble.png](http://www.thatjsdude.com/images/eventBubble.png) 11


★El término AJAX se presentó en **2005**
por primera vez en el artículo "Ajax:
A New Approach to Web Applications
[http://adaptivepath.org/ideas/ajax-ne](http://adaptivepath.org/ideas/ajax-ne)
w-approach-web-applications/ "
★En realidad, el término AJAX es un
acrónimo de **Asynchronous JavaScript +
XML** , que se puede traducir como
"JavaScript asíncrono + XML".

#### 3. AJAX

```
Jesse James Garrett
```

En el modelo C/S el usuario debe esperar a que se recargue

la página completa cada vez que hace una petición al

servidor.

#### Comunicación cliente/servidor


★Con AJAX el usuario puede seguir trabajando con la

```
información de que disponía, y el navegador muestra la
nueva información al recibirla.
```
#### Comunicación cliente/servidor en AJAX

```
12/11/
```
(^14)


#### Interacción

★AJAX mejora la interacción del usuario con la aplicación,
evitando las recargas constantes de la página.

★En el **cliente** se requiere un motor del Ajax que establece las
peticiones con el servidor de forma asíncrona, o sea implementar
en JavaScript la **API XMLHttpRequest**.
✓Ajax_pet=new XMLHttpRequest();
★En el **servidor** no se requiere nada en particular, simplemente
debe devolver el recurso que se le solicita.


#### 3.1 API XMLHttpRequest

★ **Constructor**
✓new XMLHttpRequest();
★ **Métodos**
✓ **.open(método,URL,asincrono,usuario,clave)**
● **Método: get,post,put**
● **Asincrono: true,false**
✓ **.send(datos)**
● **Datos: Tipo String. Vacía método get.**
✓ **.setRequestHeader()**
✓ **.getResponseHeader()**
✓ **.abort()**


#### Ejemplo 1

```
var Ajax1=new XMLHttpRequest();
Ajax1.open(“GET”,” http://www.example.com”);
Ajax1.send();
document.getElementByID("central").innerHTML=Ajax1.responseText;
```
★Evento captura cambios estado: **“readystatechange”**


#### API XMLHttpRequest

★ **Propiedades:
.status (respuesta del estado del servidor)
.onreadystatechange (handler del cambio estado)
.responseXML: Respuesta formato XML
.responseText: Respuesta formato HTML
.timeout: Permite indicar el timeout para que se active evento
asociado.
.withCredentials: Asignamos true/false para permitir CORS
.upload:** devuelve el objeto **XMLHttpRequestUpload**
★ **Eventos del objetho XMLHttpRequest y XMLHttpRequestUpload :**
✓loadstart
✓progress
✓abort
✓error
✓load
✓timeout
✓loadend
✓readystatechange


**Seguimiento de eventos del**

####  XMLHttpRequest 

★Los eventos de progreso en AJAX existen tanto cuando se

suben o bajan datos (download and upload transfers).

★Seguimiento del envío datos con XMLHttpRequest (download)

★Seguimiento de la recepción datos con

XMLHttpRequest.upload (upload)

```
var req = new XMLHttpRequest();
req.upload.addEventListener("progress", updateProgress, false);
req.upload.addEventListener("load", transferComplete, false);
req.upload.addEventListener("error", transferFailed, false);
req.upload.addEventListener("abort", transferCanceled, false);
```
```
var req = new XMLHttpRequest();
req.addEventListener("progress", updateProgress, false);
req.addEventListener("load", transferComplete, false);
req.addEventListener("error", transferFailed, false);
req.addEventListener("abort", transferCanceled, false);
```

#### Ejemplo Ajax GET

function cargaAjax(src_url, lugar){
var Ajax1=new XMLHttpRequest();
Ajax1.addEventListener('readystatechange', function()
{console.log(this.readyState);
if (this.readyState === 4 )
{ console.log(this.status);
if (this.status< 400 ) {lugar.innerHTML =Ajax1.responseText;}
}
});
Ajax1.open("GET",src_url);
Ajax1.send();
}
function ready()
{enlace=document.querySelector("nav a");
src_url=enlace.getAttribute("href");
enlace.addEventListener("click",function (event)
{ event.preventDefault();
cargaAjax(event.target.src, event.target.parentElement);
});
}
document.addEventListener("DOMContentLoaded", function (){ready()});

```
https://dllido.al.nisu.org/Lab2017/T5/ajaxASincro.html
```

#### Cuestiones AJAX

★ ¿Por qué está vacío el método sent?

★¿Cómo sabemos si se ha enviado la petición completa?

★¿Cómo sabemos que se ha enviado la respuesta completa?

★¿Cómo indicamos si queremos que se realice síncrono o

asíncrono?


#### 7 PromEsas- Promise

★ Patrón de diseño para controlar la ejecución de un determinado cómputo del cual
no sabemos cómo ni cuándo se nos va a devolver un determinado valor.
★ Una promesa es un objeto para que por medio de una máquina de estados
podamos controlar cuándo un valor está disponible o no.
new Promise(function(resolve, reject*) {});
★ _Resolve_ Obligatorio.Función que se ejecuta para indicar que la promesa se completó correctamente.
★ _Reject_ Opcional.Función que se ejecuta para indicar que la promesa se rechazó con un error.
var promise = new Promise(function(resolve, reject) {
// do a thing, possibly async, then...
if (/* everything turned out fine */) {
resolve("Stuff worked!");
}
else {reject(Error("It broke")); }
});


#### MéTodos

Promise.reject(reason): Devuelve el objeto Promise que es

rechazado con la razón dada (reason).

Promise.resolve(value): Devuelve un objeto Promise que es

resuelto con el valor dado (value). Si value es un thenable

(tiene un método then), la promesa devuelta "seguirá" este

thenable, adoptando su eventual estado.

Promise.all(iterable): se cumple cuando todas las promesas

en el argumento iterable han sido cumplidas. Devuelve una

lista de promesas con los valores de las promesas cumplidas.

Promise.race(iterable): Devuelve los datos de la primera

promesa en cumplirse o rechazarse.


#### MÉtodos

★ promise.then(onFulfilled,onRejected) : Método para indicar que hacer
cuando una promesa devuelve el valor deseado. Resolve
★ promise.catch(onRejected): Método para indicar que hacer cuando una
promesa devuelve el valor no deseado. Reject

```
Promise.all([pr1, pr2, pr3])
.then(doSomething)
.catch(doError);
```
https://elabismodenull.wordpress.com/2017/01/31/es6-las-promesas/


#### PromEsas- Promise

Una promesa puede encontrarse en 4 estados:

● **fulfilled (cumplida)** : la acción relacionada con la promesa se
completa con éxito.
● **rejected (rechazada)** : la acción relacionada con la promesa
no se completa con éxito.
● **pending (pendiente)** : aún no está completa ni se rechaza.
● **settled (finalizada)** : se completa o se rechaza.


#### EStados Promise

Como los métodos de las promesas devuelven

promesas, estos se pueden encadenar.


#### 5 GLOBALFETCH API

★ Objeto global para recolectar/buscar recursos.
★ Es un reemplazo moderno para XHTTPREQUEST API.

★ Tiene un diseño de API más simple y más limpio

★ Utiliza es6, Promises.

★ Implementación de nivel inferior de las peticiones HTTP.

```
✓ Ofrece una definición genérica de los objetos Request y Response.
✓ También proporciona una definición de conceptos relacionados con CORS y la
semántica de encabezado HTTP
✓ Define el método fetch(uri,request*) para hacer una solicitud y recuperar un
recurso. Devuelve una Promise que resuelve en Response sea o no correcta la
petición.
```

#### FETCH


#### Métodos y Propiedades

★ **fetch()** utilizado para obtener o inicializar un recurso.

★ **Headers** : Representa los encabezados de la

```
respuesta/solicitud, lo que le permite consultar y tomar
diferentes acciones en función de los resultados.
```
★ **Request** : Representa una solicitud de recursos.

★ **Response** : Representa la respuesta a una solicitud.

★ **Body** : Proporciona métodos relacionados con el contenido de

```
la respuesta/solicitud, lo que le permite declarar cuál es
su tipo y cómo debe manejarse.
★ Response.ok Read only true si el estado esta entre 200-299.
★ Response.status Read only Codigo http de respuesta.
```

#### Limitaciones FETCH

-No envia ni recibe ninguna **cookies**
-En caso error HTTP, resolve devuelve false.
Una promesa fetch() será rechazada con TypeError cuando se encuentre un error de red
Un 404 no constituye un error de red. Una forma precisa de comprobar que la petición fetch() es satisfactoria
pasa por comprobar si la promesa ha sido resuelta, además de comprobar que la propiedad Response.ok tiene el
valor true.
fetch('flowers.jpg').then(function(response) {
if(response.ok) {

response var objectURL .blob().then= URL(function.createObjectURL(myBlob) (^) (myBlob{ (^) );
myImage.src = objectURL;
});
console^ }^ else^ {^ .log('Network response was not ok.');
}
})

. consolecatch(function.log('There has been a problem with your fetch operation: (error) {
' + error.message);
});


#### Body

Tanto **Request** como **Response** pueden tener un **Body**

```
●arrayBuffer()
●blob()
●json()
●text()
```
Ejemplo T5Cors/login.html con Fetch con CORS


#### FORMDATA Element

★Los parámetros de un formulario se pueden recoger con el

```
objeto FormData
var formData = new FormData(form)
```
```
var formElement = new FormdData (document.getElementById("myFormElement"));
```

#### Ejemplo

#### https://dllido.al.nisu.org/Lab2017/T5/login.html (admin/admin)

**document.querySelector('#form_log').addEventListener("submit",function (event) {
event.preventDefault();
var myInit= {method:'POST', body:new FormData(event.target)};
var myRequest = new Request(event.target.action, myInit);
fetch(myRequest)
.then(function(response) {
if(response.status == 200) return response.json();
else throw new Error('Something went wrong on api server!');
})
.then(function(response) {
if (response.error) {
document.querySelector('#errores').innerHTML=datos.error;
}
else{document.querySelector('#central').innerHTML="Bienvenido";}
};})
.catch(function(error) {
console.error(error);
});
});**


#### 4 CORS

★Supongamos que tu aplicación reside en example.com y quieres
extraer datos de [http://www.example2.com.](http://www.example2.com.) Normalmente, si intentas ejecutar
este tipo de llamada AJAX, la solicitud fallará y el navegador
lanzará un error por la falta de correspondencia de los orígenes.
★Uso compartido de recursos de origen cruzado (CORS) permite

```
a las aplicaciones web de un dominio realizar solicitudes
de dominio cruzado.
```
★HTML5 introduce Cross-Origin Resource Sharing (CORS)

```
✓http://www.w3.org/TR/cors/
✓http://enable-cors.org
```

```
EI1036:Tecnologías Web para los Sistemas de Información EI1042:Tecnologías y Aplicaciones Web
```
#### CORS

★ **El servidor** [http://www.example2.com](http://www.example2.com) puede que habilitar CORS de dos
formas:
✓añadir un encabezado (header) para permitir solicitudes de
example.com: php
<?php header('Access-Control-Allow-Origin: *'); ?>
✓o en el fichero .httacess
**Header set Access-Control-Allow-Origin "*"**

```
12/11/2015
```
```
35
```

#### 5 El elemento SCRIPT

Los scripts sin src o sin atributo async o defer, son interpretados y ejecutados
inmediatamente, antes de que el navegador continúe procesando la página.
Atributos:
★ **src** : Indica el URI del recurso con programas javascript a ser cargados.
★ **type:** El tipo de contenido, por defecto. **text/javascript** : el bloque representa a un
programa clásico.
★ **charset** : Por defecto utf-8. La codificación de caracteres usada por el recurso con
programas provisto en el atributo src.
★ **async:** Un valor booleano. “ **true”** se indica que el ficheros .js del src debería ser
cargados asincrónicamente.
★ **Defer:** Un valor booleano. “ **true”** el programa será recuperado en paralelo al
procesamiento del documento y evaluado sólo cuando se haya completado el
procesamiento del documento.


#### SCRIPT

★ **crossorigin:** El valor es un enumerado **anonymous** / **use-credential.** Indica si la
petición hecha a un servidor externo debe presentar credenciales CORS o no. Este
atributo permite incrustar programas ubicados en otros servidores que soportan
acceso _cross-origin_
✓ **anonymous** : las peticiones CORS para el elemento tendrán la etiqueta "omit
credentials" establecida.
✓ **use-credentials** : las peticiones CORS para el elemento no tendrán la etiqueta
"omit credentials" establecida.


#### Ejemplo Async+Template

https://dllido.al.nisu.org/Lab2017/T5/listarTemplateAsync.h

tml

```
<script type="text/javascript"
src="listarTemplateAsync.js" async defer >
</script>
```

#### 5 Iframe Node

★Permite anidar un documento html dentro de otra página

HTML.

★Cada elemento <iframe> tiene su propio historial de sesión

y su propio objeto Document.

★El contexto de navegación de nivel superior del iframe es

la ventana del navegador: window

★ **window.frames** devuelve la lista de iframes del documento.


#### Sample Iframe

< **!DOCTYPE html>
<html><head>
<meta charset="utf-8">
<title>Web page parsing</title>
</head>
<body>
<div>
<h1>Web page parsing</h1>
<p>This is an example Web page.</p>
</div>
<iframe width="400" height="215" frameborder="0"
scrolling="no" marginheight="0" marginwidth="0"
src="https://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=es-419&amp;geocode=&amp;q=
buenos+aires&amp;sll=37.0625,-95.677068&amp;sspn=38.638819,80.859375&amp;t=h&amp;ie=UTF8
&amp;hq=&amp;hnear=Buenos+Aires,+Argentina&amp;z=11&amp;ll=-34.603723,-58.381593&amp;ou
tput=embed"></iframe>**

**</html>**

```
https://dllido.al.nisu.org/Lab2017/T4/webDOMIframe.html
```

###### 4 Función Flecha =>

###### (arrow functions)

```
Forma de definir funciones anónimas más corta.
([param] [, param]) => { instrucciones }
```
```
param => expresión (si sólo un parámetro sin ())
var elementos = [
"Hidrógeno",
"Helio",
```
"Litio""Beril-io", (^)
];
elementos.map(function(elemento){
(^) }); return// [8, 6, 7, 9] elemento. length;
elementos.map((elemento) => {
return elemento.length;
});var elementos3 // [8, 6, 7, 9]= elementos (^) .map( e => e.length ); // [8, 6, 7, 9]
//El método array.map() crea un nuevo array con los resultados de la llamada a la
función indicada aplicados a cada uno de sus elementos.^
(^)
*
41


### Índice

```
★Usabilidad y Accesibilidad
6.1 Estándares
6.2 Normativas
Ejercicios
```
★Seguridad

```
6.3 Tipos de Seguridad
6.4 Ejemplos vulnerabilidades:
ClickHacking
```
#### Robo sesiones

```
★6.5 Vigilancia de la
seguridad
★Web Movil
6.6 Optimización CRP
6.7 Diseño responsive
```

#### 6.1 Normativas accesibilidad

● UAAG: **User Agent Accessibility Guidelines (for developers of
Web browsers,)**
● WCAG: **Web Content Accessibility Guidelines (site designers)**
● y ATAG : **Authoring Tool Accessibility Guidelines (HTML
editors)
● WAI-ARIA** : Accessible Rich Internet Applications.It especially helps
with dynamic content and advanced user interface controls


#### Normativas accesibilidad

● Norma UNE 139803:2004 (PDF), sustituida por la Norma UNE 139803:2004
● **Norma UNE 139803:2012 (PDF)** , es equivalente a las WCAG 2.0
● WCAG 1.0, W3C, recomendación de 1999.
● **WCAG 2.0** , W3C, recomendación 2008
○ WCAG 2.0 en español, SIDAR
○ Comprender las WCAG 2.0 (traducción de la versión del 14/10/2010)
● **WCAG 2.1** , W3C, Draft
● **WAI-ARIA 1.0** , W3C recomendación de 2014
● **UAAG 1.0** (User Agent Accessibility Guidelines 1.0), W3C, recomendación de 2002
● UAAG 2.0, W3C Working Draft, 2015
● ATAG 1.0, W3C, recomendación del 2000, sustituidas por las ATAG 2.0
● **ATAG 2.0** , W3C, recomendación desde 2015
○ ATAG 2.0 Implementation Report, cuadro resumen del cumplimiento de las ATAG 2.0 (Drupal, WordPress,
Word, etc.), W3C, draft 2014


#### 6.2 Legislación Española

**Ley 34/2002, de 11 de julio, de Servicios de la Sociedad de la Información y de Comercio Electrónico.** LSSI
(B.O.E. de 12-7-02). : Se fijaba por primera vez la obligación de que las páginas web de la Administración Pública
española fueran accesibles
Ley 9/2017, de 8 de noviembre, de Contratos del Sector Público, por la que se transponen al ordenamiento jurídico
español las Directivas del Parlamento Europeo y del Consejo 2014/23/UE y 2014/24/UE, de 26 de febrero de 2014.
se incluyen requisitos de _accesibilidad universal y diseño universal o diseño para todas las personas_.

● La publicación de la Directiva (UE) 2016/2102 del Parlamento Europeo y del Consejo, de 26 de octubre de 2016,
sobre la accesibilidad de los sitios web y aplicaciones para dispositivos móviles de los organismos del sector
público, que deberá ser transpuesta a la legislación española antes de septiembre de 2018, y que establece los
requisitos de accesibilidad de los sitios web y apps del sector público.
Esta norma es el estándar europeo que especifica los requisitos funcionales de accesibilidad de los productos y
servicios TIC: los requisitos de accesibilidad de los sitios web (equivalentes al nivel **AA de las WCAG 2.0** ), del
hardware, del software, de los documentos, etc.


#### Ejercicio 1

**Leer : [http://www.sidar.org/traducciones/wcag20/es/](http://www.sidar.org/traducciones/wcag20/es/)**

Cita 10 Normas que debería cumplir un portal web.


#### Ejercicio 2

[http://www.usableyaccesible.com/archivos/relacion_equivalencia_301](http://www.usableyaccesible.com/archivos/relacion_equivalencia_301)
549_WCAG20.xlsx

Por parejas intentar analizar el portal de la UJI y rellenar la hoja
excel.

SOLUCIÓN:
★★ https://docs.google.com/document/d/1V3UgVbwnwxSuBTGteMk2xZhxL3DmoMxz1ojNVLGnLCk/edithttps://docs.google.com/document/d/1d7ovEd79NUav44rrDvxuEqmyk78F4Cxm2F4t8nke9H4/edit


#### 6.3 Seguridad

★La seguridad supone un coste económico y de

```
eficiencia.
✓El riesgo cero no es práctico
✓Hay diversas formas de mitigar el riesgo
✓No se puede gastar un millón para proteger un
céntimo
```

#### Tipos de seguridad:

1.Seguridad en el Cliente

2.Seguridad en el Servidor

3.Seguridad en la Comunicación

4.Seguridad en la Aplicación


#### 6.3.1 Seguridad en el Cliente:Código móvil

★Código que circula por la red y se ejecuta en una máquina

remota(cliente)

★Aparece incrustado en un documento HTML. Un cliente de

```
correo o un navegador que cargue el documento lo ejecutará
en la máquina cliente.
```
★Potencia la funcionalidad de los documentos HTML pero

```
entraña riesgos de seguridad. Un código móvil puede obtener
información acerca de un sistema o un usuario y enviarla a
una máquina remota
```
★Un método de protección común es tener siempre actualizado

el software.


#### 6.3.2 Seguridad en el Servidor

★El desarrollo de una aplicación web requiere herramientas:
✓servidores web,
✓servidores de aplicaciones,
✓servidores de bases de datos,
✓lenguajes de servidor, etc.
★Estas herramientas pueden plantear problemas
✓Vulnerabilidades debidas al uso de versiones no actualizadas
✓Configuraciones por defecto inadecuadas
✓Activación de cuentas por defecto
★Las herramientas deben estar actualizadas y bien configuradas para
impedir ataques a la aplicación.


**Seguridad en el Servidor:**

#### 1.Servidor Web

★Precauciones a tener en cuenta:

```
✓Establecer permisos adecuados para los ficheros del
servidor.
✓Definir un usuario y grupo especiales (web, www).
✓Listado automático de directorios. Puede ser conveniente
pero proporciona información sensible.
✓Seguimiento de enlaces simbólicos. Peligroso si se
enlazan ficheros externos al árbol de documentos.
```
★Revisar periódicamente los ficheros de log (access_log y

error_log en Apache) para detectar posibles ataques.

★Configurar los servicios del servidor HTTP necesarios y

deshabilitar los que no se utilizan. (^52)


**Seguridad en el Servidor:**

#### 2. Servidor de Bases de Datos

★Riesgos:

```
■Descubrimiento de información acerca de los datos de
conexión al servidor (usuario y clave), información
sensible almacenada en la base de datos (tarjetas de
crédito...) o información sobre la estructura de la base
de datos
■Modificación de las instrucciones SQL enviadas al
servidor, construidas de forma dinámica a partir de
datos recibidos del usuario y por tanto potencialmente
peligrosos ( Inyección SQL )
■Acceso no autorizado a información restringida
```

**Seguridad en el Servidor:**

#### Servidor de Bases de Datos

★Vigilar la configuración por defecto del servidor,(evitar

bases de datos y usuarios predefinidos)

★No ejecutar el servidor BD como root.

★No dar a usuarios de Web acceso a la tabla de usuarios

excepto al administrador.

★Asegurarse el administrador tiene un password seguro

★Restringir el acceso remoto al servidor

★No dar a un usuario más permisos que los estrictamente

necesarios

★Almacenar los datos sensibles de forma encriptada


#### 6.3.3 Seguridad en la Comunicación;HTTPS

★Proteger la información cuando se envía con protocolos seguros
✓SSL (Secure Socket Layer) es el primer protocolo para
asegurar el transporte de datos entre el cliente y el servidor
web. Diseñado inicialmente por Netscape, hoy día es soportado
por la mayoría de los servidores web
■Podemos reconocer una conexión HTTP sobre SSL porque
aparece el prefijo ‘https’ en lugar de ‘http’ en la URL


● Los datos utilizados con HTTPS son seguros vía **TSL**

```
(Transport Layer Security protocol). Versión actualizada y
más segura del SSL.
● HTTPS permite estas capas de protección:
✓ encriptación : si algún atacante consigue interceptar esa
información, no le servirá para nada ya que no sabrá
descifrarla (pero tú sí).
✓ integridad de datos: los atacantes no podrán “modificar” el
contenido del mensaje enviado.
✓ autenticación : se evitan los ataques de suplantación de
identidad phishing o intermediarios (“ man in the middle ”) en
el que tu usuario proporciona información a terceros cuando
cree que te los está dando a ti.
```
#### HTTPS


#### Pasos instAlAr HTTPS

★ Generar un certificado: https://certbot.eff.org/ Autoridad

```
certificadora que permite solicitar un certificado
gratuito.
```
★ Como instalar el certificado en servidor https.

```
https://openwebinars.net/blog/configurar-certificados-ssl-
gratis-en-ubuntu-con-apache/
```
★ Modificar las rutas para que incluyan https

★ Redirigir https fichero .htaccess

```
★ Comprobador de instalación SSL.
```
```
RewriteEngine On
RewriteCond %{HTTPS} !on
RewriteRule (.*)
https://%{HTTP_HOST}%{REQUEST_URI} [L,R=302]
```

#### PHP con HTTPS

<?php if

(! isset($_SERVER['HTTPS']) or $_SERVER['HTTPS'] == 'off' )

{ $redirect_url = "https://". $_SERVER['HTTP_HOST'].
$_SERVER['REQUEST_URI']; header("Location: $redirect_url");
exit(); }

?>


#### Comunicación HTTPS

```
● Un navegador se intenta conectar con un sitio web protegido con SSL.
● El navegador solicita que el servidor web se identifique.
● El servidor envía una copia de su certificado SSL al navegador.
● El navegador comprueba si confía en el certificado SSL. En caso afirmativo, envía
un mensaje al servidor.
● A su vez, el servidor envía una confirmación firmada digitalmente para iniciar una
sesión SSL cifrada.
```
**Desventajas** del HTTPS en un sitio web son dos:
★ Lo costoso del sistema: es necesario usar un servicio de seguridad que se
encarga de verificar y demostrar la autenticidad de cada conexión.
★ Disminución de la velocidad de carga de las páginas: es necesario acceder a un
tercer sitio antes de cargar el contenido de cualquier página.


**Seguridad en el Servidor:**

#### 6.3.4 Lenguajes de programación en servidor/cliente

★Proteger el código fuente para evitar que pueda ser

```
visualizado, especialmente cuando contiene información
sensible como pueden ser los datos de conexión al servidor
de bases de datos
```
★Sacar el código fuente sensible fuera de la raíz de la

web, y protegerlo contra lectura.

★Validar las instrucciones SQL antes de enviarlas al

servidor.

★No revelar información sobre la base de datos en los

```
mensajes de error (esquema, naturaleza de los datos
almacenados, fragmentos SQL)
```

#### 6.4 ClickJacking: robo de clics

★http://www.elladodelmal.com/2015/08/el-ironframe-para-luchar-contra-ataques.html
★Cuando el atacante quiere hacer un esquema de ClickJacking, inyecta un
iframe en una web vulnerable y en ese iframe incluye la web de la que
quiere robar los clics a la víctima.
★ **Solución** proteger nuestros clientes: Evitar la inclusión de una web en
un iframe por medio de HTTP Headers X-Frame-Options.
✓ **x-frame-options: DENY | SAMEORIGIN**
✓Añadir en fichero .htaccess
**Header always append X-Frame-Options SAMEORIGIN**
★Si esto está activo en la consola dará este error al incluir la página
en otra web.:
Refused to display
'https://www.google.es/maps/@38.9421251,-0.3578288,19z' in a frame
because it set 'X-Frame-Options' to ‘SAMEORIGIN'.


#### Robo sesiones

session_start();

if (!isset($_SESSION['ACTIVO']))

{ $_SESSION = array();

session_regenerate_id();

setcookie(session_name(), '', time() +3600);

$_SESSION['ACTIVO'] = 1;

$menu="menu_new.phtml";

}

else

{ $menu="menu.phtml";}


###### 6.5: Seguridad: Top 10

###### https://www.owasp.org

#### The Open Web Application Security Project (OWASP).

```
● Informe2017 https://www.owasp.org/images/b/b0/OWASP_Top_10_2017_RC2_Final.pdf
● Top 10
✓ A1-Injection
✓ A2-Broken Authentication and Session Management
✓ A3-Cross-Site Scripting (XSS)
✓ A4-Broken Access Control
✓ A5-Security Misconfiguration
✓ A6-Sensitive Data Exposure
✓ A7-Insufficient Attack Protection
✓ A8-Cross-Site Request Forgery (CSRF)
✓ A9-Using Components with Known Vulnerabilities
✓ A10-Underprotected APIs
```

#### Ejercicio 3

Define y pon un ejemplo de los ataques top 10.


#### Evolución


#### Enlaces de Interés

★http://www.w3.org/TR/XMLHttpRequest/
★https://developer.mozilla.org/es/docs/XMLHttpRequest/Using_XMLHt
tpRequest
★https://fetch.spec.whatwg.org/#
★https://developer.mozilla.org/es/docs/Web/API/Fetch_API/Utilizan
do_Fetch
★http://www.etnassoft.com/2016/10/10/estudiando-la-nueva-api-fetc
h-la-evolucion-natural-de-xhr-en-el-nuevo-javascript/
★https://developer.mozilla.org/es/docs/Web/JavaScript/Referencia/
Funciones/Arrow_functions


#### Bibliografía

```
✓ https://www.html5rocks.com/es/tutorials/internals/howbrowserswork/
✓ https://developer.mozilla.org/en-US/docs/Web/API
✓ http://www.thatjsdude.com/
✓ https://javascript.info
```
EDITOR JS+HTML+CSS

[http://jsfiddle.net/](http://jsfiddle.net/)
https://codepen.io/idesi/pen/rLgaJO



This is a offline tool, your data stays locally and is not send to any server!
Feedback & Bug Reports