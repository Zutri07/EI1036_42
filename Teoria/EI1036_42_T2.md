---
theme : "white"
transition: "zoom"
highlightTheme: "darkula"
customTheme : "lola_theme"
---

# Tema 2: Introducción al PHP

### EI1042 - Tecnologías y Aplicaciones Web

**EI1036- Tecnologías Web para los Sistemas de Información (2018/2019)**

*Professora: Dra. Dolores Mª Llidó Escrivá*

[Universitat Jaume I](https://www.uji.es/).

*https://github.com/dllido/EI1042_36/tree/master/Ejercicios/T2*

---

## Índice

- Introducción a PHP
- Sintaxis básica
- Tipos de datos
- Salida Estándar
- Variables Expresiones y Operadores
- Funciones
- Formularios
- Objetos

---

# 1. Introducción al PHP

- Creado por Rasmus Lerdorf para uso personal en 1994 ![Image of Rasmus](./media/T2/rasmus.jpeg)
- PHP es un lenguaje de script del lado del servidor.
- PHP: Hypertext Preprocessor
- Versión actual: PHP 7
- Es potente, fácil de aprender, de libre
distribución, permite el acceso a bases de datos y otras
funcionalidades orientadas a la red
- Dispone de abundante soporte en la Web
  

---

## Ficheros con PHP
-  Fichero PHP:  hola.php

``` PHP 
<?php 
echo "Hola Mundo";
?>
```
- Fichero con HTML: bienvenido.php

``` HTML
<body>
<p>Inicio</p>
<?php 
$nombre = "Ana";
print(" <P>Hola, $nombre</P>"); 
 ?>
<p>Fin</p>

```


---

## Ejecución PHP

-  Consola

- ```php.exe "./bienvenidos.php"```
- Entorno php:
```
php.exe
$hola=“Adios”;
$echo $hola
```
-Servidor web:
https://piruletas.000webhostapp.com/Teo/T2/holaMundo.php

---

## Configuración php

-  Fichero: php.ini
-  Visualizar la configuración del servidor: función  phpinfo()

https://piruletas.000webhostapp.com/teoria/T2/form0Info.html

---

##  Páginas web dinámcas con PHP

- El cliente no ve el código PHP sino los resultados que produce en la salida estándar.
- Apache ejecuta php no como un CGI sino como un módulo.Version php  
-S.O. != Apache

![Image of La World Wide Web](./media/T2/image1.png)



---

### Cuestiones
https://piruletas.000webhostapp.com/Lab/P1/includes/portal.php?action=listar

Analiza la url.
- ¿Cual es el nombre servidor?
- ¿Cual es el recurso?
- ¿Que parametros requiere el programa php?

---

##  Servidor WEB Local

Local:
- Instalar PHP
- Ejecutar:
``` php -S localhost ```

php [options] -S <addr>:<port> [-t docroot]

[http://localhost:8088/T1/tutoPhp.php](http://localhost:8088/T1/tutoPhp.php)



Manual PHP: http://php.net/manual/es/

--

### Cuestiones

- ¿Que es el docroot del servidor web?
- ¿Donde ponemos el fichero tutoPhp.php en el servidor?


---

##  Servidor WEB en Producción


- Servidor web Apache (http://www.apache.org) con el módulo PHP (http://www.php.net)
- Base de datos MySQL (http://www.mysql.com) si se desea crear páginas dinámicas
- Herramientas para la gestión de MySQL, como PHPMyAdmin
(www.phpmyadmin.net)

[Apache 2.3 http://httpd.apache.org/docs/current/es/](http://httpd.apache.org/docs/current/es/)

---

## Servidor WEB  en desarrollo: XAMPP 

 * XAMPP es una distribución de Apache que incluye MySQL, PHP y  phpMyAdmin
 * XAMPP es gratuito y fácil de instalar
 * XAMPP es multiplataforma
 * Precaución: la configuración por defecto  no es segura, ni para un entorno de producción.

---

# Sintaxis básica PHP

- PHP es sensible a las mayúsculas/minúsculas.
- Las instrucciones se separan con ";"
- Espacios en blanco y cambios de línea no se tienen en cuenta.
- PHP interpreta entre comillas dobles pero no entre comillas
simples.
- Se utiliza codificación utf8.
- Comprobar que el editor no ha generado un BOM ( *byte order mark* de unicode en la primera línea)



Guia Estilos: https://www.php-fig.org/psr/psr-2/

--

### Ejemplo fichero PHP

``` PHP
<?php
$var = "test";
echo "$var"; // Salida:"test“
echo "\$var"; // Salida:" "$var"
echo '$var'; // Salida:" "$var"
# otro comentario hasta el final de la línea
/* comento
varias líneas */
?>
```

--

### Usar: YodaStyle
![Image of La World Wide Web](./media/T2/image2.png)

Escribir comparaciones  al revés ( Yoda habla al revés).

En ocasiones podemos equivocarnos  _if ($value = true)_ y ...simplemente estamos
asignado SIEMPRE true a nuestra variable. Nos costaría identificar el error en nuestro código.



---

# Tipos de datos

- Tipos escalares: boolean, integer, double, string
- Tipos compuestos: array, object
- Tipos especiales: resource, NULL
 



--

### Array Asociativo

Sintaxis:
array ([clave =>] valor, ...)

```PHP 
$medidas = array (10, 25, 15);
echo $medidas[0]

$color = array (‘rojo’=>101, ‘verde’=>51, ‘azul’=>255); 

#Acceso:
echo $color[‘rojo’] // No olvidar las comillas
echo array_keys($color)
```

---

# Salida estándar

¿Cómo enviar mensajes a la salida estándar?
-  echo — Muestra una o más cadenas.
-  print — Mostrar una cadena.
-  printf — Imprimir una cadena con formato.
-  print_r — Imprime información legible para humanos.
-  var_dump— Vuelca información sobre una variable. La información y su tipo

--

## Diferencias echo o print
-  Void echo (string argument1[,...string argumentN])
-  Int print (argument)


    *  Print sólo tiene un argumento (echo puede tener varios)
    *  print devuelve 1 (significa que ha generado la salida)

No es obligatorio el uso de paréntesis ya que no son
realmente una función.
```PHP
echo “Hola mundo”;
echo “Hola “, “mundo”; 
print “Hola mundo”;
print “Hola “. “mundo”;
```

---

#  Variables

- No se declara el tipo de las variables.
- Las variables se pueden asignar
    -  Por valor
    -  Por referencia (con &)
    - Creación de nombres de variables dinámico.

```PHP
$x='equis';
$_x = &$x; //referencia a $x
$_x ='x';
echo $x; //x
echo $_x; //x
$a = "hola";
$$a = "mundo";
print "$a $hola\n";
//hola mundo
print "$a ${$a}";
//hola mundo 18
```

---

## ¿Que tipo es la variable? 


-  gettype() devuelve el tipo de una variable
- is_type() comprueba si una variable es de un tipo dado:

``` is_array(), is_bool(), is_float(), is_integer(), is_null(), is_numeric(), is_object(), is_resource(), is_scalar(),is_string()```


---

## Ámbito de variables

- Local: Variable definida en una función
    -  Está limitada a dicha función.
    -  Se elimina al acabar la ejecución de la función
    -  Salvo si la variable se declara como **static** .
- Global:
    -  No se puede definir dentro de las funciones a menos que :
       - se declare en la función con la palabra clave 'global'
       - O que se acceda con el array $GLOBAL[indice]
    -  Existen durante todo el tiempo de proceso del fichero
    -  Al acabar de procesar el fichero se eliminan las variables globales
 


---

## Superglobal

- Variables predefinidas en PHP
- Están disponibles en todos los ámbitos.

Ejemplos:

- $GLOBALS — Array con todas las variables disponibles en el ámbito global
- $_SERVER — Información del entorno del servidor y de ejecución
- $_GET(POST) — Variables HTTP GET(POST)
- $_FILES — Variables de Carga de Archivos HTTP
- $_REQUEST — Variables HTTP Request
- $_SESSION — Variables de sesión
- $_COOKIE— Variables con datos de la cookie
- $_ENV— Variables del entorno


---

# Ejercicio
https://piruletas.000webhostapp.com/teoria/T1/tutoPhp.php

- Analiza este fichero y mira el funcionamiento.

---


### Ejercicios

```HTML
RADIO
<form action=’procesar.php” method=”get”>
Sexo:
<INPUT TYPE="radio" NAME=“sexo" VALUE=“M" CHECKED >Mujer
<INPUT TYPE= "radio" NAME=“sexo" VALUE=“H">Hombre
<INPUT TYPE=”submit”>
</form>
```
```PHP 
#Procesar.php
<?PHP
$sexo = $_REQUEST[‘sexo’];
print ($sexo);
?>
```

---

## Ejercicio:
 - ¿Cuál es la petición al servidor al pulsar submit?
 - ¿Que aparecerá por pantalla?
 https://piruletas.000webhostapp.com/teoria/T1/form0.html



---

### Formularios desde PHP

CHECKBOX

```php
<INPUT TYPE="checkbox" NAME="extras[]" VALUE="garaje" CHECKED>Garaje
<INPUT TYPE="checkbox" NAME="extras[]" VALUE="piscina">Piscina
<INPUT TYPE="checkbox" NAME="extras[]" VALUE="jardin">Jardín
```
``` PHP 
<?PHP
$extras = $_REQUEST[‘extras’];
foreach ($extras as $extra)
print (“$extra<BR>\n”);
?>
```

---

### Formularios desde PHP

BUTTON

```PHP 
<INPUT TYPE="button" NAME=“actualizar" VALUE="Actualizar datos">
```

```PHP
<?PHP
$actualizar = $_REQUEST[‘actualizar’];
if ($actualizar)
print ("Se han actualizado los datos");
?>
```

---

### Formularios desde PHP

SELECT múltiple

```
Idiomas:
<SELECT MULTIPLE SIZE="3" NAME="idiomas[]">
<OPTION VALUE="ingles" SELECTED>Inglés
<OPTION VALUE="francés">Francés
<OPTION VALUE="alemán">Alemán
<OPTION VALUE="holandés">Holandés
</SELECT>
```
```
<?PHP
$idiomas = $_REQUEST[‘idiomas’];
foreach ($idiomas as $idioma)
print (“$idioma<BR>\n”);
?>
```


---

# Funciones

Ejemplo:
```PHP
function suma ($x, $y)
{
$s = $x + $y;
return $s;
}
```
Salida:
```
$a=1;
$b=2;
$c=suma ($a, $b);
print $c;
```

---

#### Funciones

- Por defecto paso parámetros por valor
- Paso por referencia:

```PHP
function incrementa (&$a)
{
$a = $a + 1;
}
$a=1;
incrementa ($a);
print $a; // Muestra un 2
```

---

#### Funciones

- Argumentos por defecto
- Los argumentos con valores por defecto deben ser siempre
los últimos:
```PHP
function muestranombre ($nombre, $titulo= "Sr.")
{
print "Estimado $titulo $nombre:\n";
}
muestranombre (“Fernández”);
muestranombre (“Fernández”, "Prof.");
```
Salida:
```
Estimado Sr. Fernández:
Estimado Prof. Fernández:
```


---

# Ejemplo funciones y sessiones

```
<?php
function activarSession()
{
    if (!isset($_SESSION["activo"])) {
        $_SESSION = array();
        setcookie(session_name(), '', time() + 10);
        $_SESSION["activo"] = 1;
        print "<h2>Hola</h2>";
        $_SESSION["usuario"] = "visitante";
        return 0;
    } else {
        if ($_SESSION['last_action'] < time() - 60 /* be a little tolerant here */ ) {
            session_destroy();
        }// destroy the session and quit

        print "<h2>Bienvenido de nuevo " . $_SESSION["usuario"] . "\n</H2>";
        return 1;
    }
}

print "</p>Cookies</p>";
print_r($_COOKIE);
session_start();
if (1 == activarSession()) {
    print "<p> Ya tenías una sessión activa</p>";
}
print "</p>Session</p>";
print_r($_SESSION);

?>
 ```   
 [https://piruletas.000webhostapp.com/teoria/T1/session.php](https://piruletas.000webhostapp.com/teoria/T1/session.php)

---

Inconvenientes uso sessión:
El mayor conflicto cuando se utilizan sesiones de PHP tiene que ver con los identificadores de sesión únicos. Debido a que la cadena de identificación de cada usuario es única, este "busto caché" con cada nuevo usuario para visitar su sitio. ¡Este tipo de sistema no se escalará con muchos usuarios concurrentes del sitio! Con esto en mente, nuestro sistema ignora específicamente los encabezados que definen una cookie PHPSESSID.

Más allá de las implicaciones de rendimiento y escala, las Sesiones PHP presentan otros problemas. De forma predeterminada, las sesiones de PHP almacenan datos en el sistema de archivos como su propio archivo único. Escribir datos en un archivo es un proceso de E / S, y se sabe que este tipo de procesos hace una copia de seguridad y causa una gran carga de servidor si su sitio recibe demasiados usuarios simultáneos. Sin mencionar que este tipo de almacenamiento de sesión simplemente no funciona si su sitio está en una solución agrupada que abarca múltiples servidores web.

Sin mencionar que existen varias vulnerabilidades de seguridad centradas en las sesiones de PHP. Las vulnerabilidades incluyen la exposición de los datos de la sesión, la fijación de la sesión y el secuestro de la sesión.


---

# OOP en PHP

- PHP no es un lenguaje 100% Orientado a Objetos.
- Soporta:
- Encapsulamiento.
- Tipos Abstractos de Datos y ocultamiento de la
Información.
- Herencia.
- Polimorfismo.


---

## CLASES


- La definición básica:

```<?php
class Myclass{

    const CONST_VALUE = 10;
    public $numero=5;
    function dameNumero(){
      return self::CONST_VALUE*$this->numero;
    }
    function llamoDame(){ return self::dameNumero();}
}
$classname = 'Myclass';
echo $classname::CONST_VALUE,"</p>"; // A partir de PHP 5.3.0
echo Myclass::CONST_VALUE,"</p>";


$datos=new  Myclass();
$datos->numero=15;
echo $datos->dameNumero(),"</p>";
echo $datos->llamoDame(),"</p>";

//Da error
 echo Myclass::dameNumero();
?>

```
El Operador de Resolución de Ámbito :: (también denominado Paamayim Nekudotayim) o en términos simples, el doble dos-puntos, es un token que permite acceder a elementos estáticos, constantes, y sobrescribir propiedades o métodos de una clase. 


### Objetos
```PHP
$Paco=New cliente();
$Paco->numero=5
$Paco->dame_numero();
```


---

### Ejemplo: Constructor/Destructor
```PHP 
class cliente{ 
var $nombre; 
var $numero; 
var $peliculas_alquiladas; 
function __construct($nombre,$numero){ 
$this->nombre=$nombre; 
$this->numero=$numero; 
$this->peliculas_alquiladas=array();  } 
function __destruct(){ 
echo "<br>destruido: ". $this->nombre; } 
function dame_numero(){ 
return $this->numero;  } 
} 
//instanciamos un par de objetos cliente 
$cliente1 = new cliente("Pepe", 1); 
$cliente2 = new cliente("Roberto", 564); 
//mostramos el numero de cada cliente creado 
echo "El identificador del cliente 1 es: ". $cliente1->dame_numero(); 
echo "<br>El identificador del cliente 2 es: ". $cliente2->dame_numero();
```

---

### Herencia: extends

- La Herencia permite a una clase, “heredar”, los métodos y atributos para
este proceso es usada la palabra reservada extends seguida de la que
será su clase “padre”.
- Cuando se extiende una clase, la subclase hereda todos los métodos
públicos y protegidos de la clase padre. A menos que una clase
sobreescriba estos métodos, mantendrán su funcionalidad original.


---

### Ejemplo Objetos

```PHP
class Foo{
    public function printItem($string)    {
        echo 'Foo: ' . $string . ”\n”;    }

class Bar extends Foo
{    public function printItem($string)
    {        echo 'Bar: ' . $string . ”\n”;
   }}
$foo = new Foo();
$bar = new Bar();
$foo->printItem('baz'); // Salida: 'Foo: baz
$bar->printItem('baz'); // Salida: 'Bar: baz'
```

[https://piruletas.000webhostapp.com/teoria/T1/obj1.php](https://piruletas.000webhostapp.com/teoria/T1/obj1.php)


---

### $this, self, parent


-  $this es una variable especial de auto-referencia del objeto para
acceder a sus métodos y propiedades.
- self y parent: son pseudo-variables para acceder a una propiedad o método  de una clase.

-  Diferencia entre $this y self::
- Usa $this para hacer referencia al objeto (instancia) actual, y se
utiliza self:: para referenciar a la clase actual. 

``` PHP
$this->nombre 
self::nombres
```

---



# Bibliografía

- PHP: [http://es.php.net/manual/es/](http://es.php.net/manual/es/)
Guia Estilos: https://www.php-fig.org/psr/psr-2/

- Apache: [http://httpd.apache.org/docs/2.3/es/](http://httpd.apache.org/docs/2.3/es/)



---

#### ¿Dudas?

  ![Image de Dudas](./media/image8.png)