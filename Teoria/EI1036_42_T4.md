 PDF To Markdown Converter
Debug View
Result View

# Tema 5:

# WP: templates/plugins

# http Avanzado:

# Autentificación/sesiones.

## EI1042 - TECNOLOGÍAS Y WEB

## EI1036 - TECNOLOGÍAS WEB PARA LOS SISTEMAS DE INFORMACIÓN

## PROFESORA: DRA. DOLORES Mª LLIDÓ ESCRIVÁ

## PAGINA PERSONAL DLSI


#### Índice



En WordPress se manejan algunos conceptos que son generales al mundo web y otros más específicos de WordPress:
3.1 Página
Las páginas son la unidad básica cuando se quiere publicar contenido sin dependencia temporal, es decir, cuando se quiere construir un sitio web clásico, con distintos apartados. Por ejemplo, si quieres construir el sitio web de una empresa, puedes querer publicar la historia de la empresa. Eso puede ser una página, que editarás y modificarás pocas veces.
3.2 Entrada o artículo
Frente a la página, la entrada (post) es la pieza básica de contenido de las bitácoras (blogs). La bitácora se compone de entradas con una determinada fecha de publicación. Las entradas no suelen modificarse nunca, sino que se añaden nuevas periódicamente.
3.3 Comentario
Los comentarios son publicaciones normalmente breves que se asocian a un artículo y que suelen estar hechas por terceras personas. Su gestión permite muchas variantes. Puede autorizarse a cualquiera a escribir un comentario, sólo a usuarios de la página o a nadie. Los comentarios aparecerán directamente o deberán ser aprobados por un moderador previamente a su publicación.
3.4 Categoría
Las categorías son la forma de agrupar y clasificar contenido en WordPress. Admiten la construcción de jerarquías. Una página o una entrada puede pertenecer a una o varias categorías. Es decir, una categoría es un concepto global al que pertenece una página. La lista de categorías sería como la tabla de contenidos de un libro.
3.5 Etiqueta
Las etiquetas (tags) son los conceptos que queremos señalar que aparecen en las páginas o artículos que publicamos. A veces se confunden con las categorías, pero se distinguen con un criterio sencillo: las categorías son como una tabla de contenido, mientras la colección de etiquetas sería el glosario. Más información aquí.
3.6 Tema
Los temas son plantillas que se utilizan en WordPress para modificar la apariencia y diseño del sitio. Existen multitud, algunos son gratuitos y otros son de pago.
3.7 Plugin
Los plugins son complementos de software que aumentan las capacidades y posibilidades de WordPress. Los plugins se usan para mejorar WordPress en diferentes áreas como marketing, redes sociales, seguridad, SEO, diseño web, contenido, tráfico web, etc. Como contrapartida, los plugins hacen nuestra instalación más “pesada”, es decir, que cargar cualquier página de nuestro sitio puede ser más lento, pues partes del plugindeben ejecutarse siempre. En los más de 10 años que WordPress lleva en marcha, se han escrito plugins prácticamente para cualquier cosa, y esta es una de las bases de éxito de WordPress. Cuando necesitemos una funcionalidad nueva, buscaremos si existe un plugin y, si no, podemos encargar uno a medida. 


#Plugin/Theme/childTheme

3.8 Widgets
Los widgets son pequeños bloques con herramientas que realizan funciones específicas y que están pensados para ubicarse en ciertas áreas del tema en curso, como el pie o la barra lateral (sidebar). Ayudan a darte un mayor control sobre el diseño y contenido de tu sitio web o blog. Los widgets se pueden expandir y usar de diferente forma dependiendo del tema y de los plugins que se instalen.
3.9 Atajos (shortcuts)
Cuando escribimos el contenido de una página o una entrada, es posible que además de texto querramos añadir alguna funcionalidad específica. Para ello, algunos plugins proveen una forma de invocar funciones propias, los denominados shortcuts, que consisten en determinado texto entre las marcas [ ]. Cuando la página es presentada al visitante, lo que hay entre las marcas se sustituye por el resultado de la función concreta que se ha invocado.
3.10 Usuarios
Si alguien más va a contribuir a tu sitio o necesita acceso (por ejemplo a un foro), puedes añadir más usuarios. En WordPress hay diferentes roles de usuarios:
Super Admin – Quien cuenta con acceso a la característica de administración de la red de sitios completa. Cabe señalar que una instalación de WordPress permite gestionar varios sitios en el mismo alojamiento, sin tener que instalarlo varias veces. Esta funcionalidad no la estudiamos en esta práctica.
Administrador – Quien tiene acceso a todas las características de administración de un sitio en particular.
Editor – Quien puede publicar y editar entradas, propias y de otros usuarios.
Autor – Quien puede publicar y editar sus propias entradas.
Colaborador – Quien puede escribir y editar sus propias entradas, pero no publicarlas.
Subscriptor – Quien solamente puede editar su perfil.
3.11 Escritorio
El escritorio de WordPress es la zona donde se administra, se agrega contenido, se actualiza, se instalan plugins y muchas otras tareas esenciales para que la plataforma tenga un óptimo desempeño. El administrador del sitio encuentra9):
Escritorio principal (pantalla de inicio). Esta es la parte principal del escritorio de WordPress. Aquí verás algunos elementos como los datos de publicación (número de entradas, páginas, comentarios, etc.), la actividad reciente, un borrador rápido y noticias del mundo de WordPress. Todo esto se puede modificar y seleccionar qué quieres que aparezca y qué no en “Opciones de Pantalla”.
Actualizaciones. En esta opción podrás ver todo lo relacionado con las diferentes actualizaciones disponibles para WordPress, incluyendo la versión de la plataforma, temas y plugins. Es importante mantener actualizado todo, por motivos de seguridad.
Entradas. Desde aquí puedes administrarlas. También en esta sección podrás agregar y modificar tanto categorías como etiquetas.
Medios. Agrega imágenes, archivos y hasta pequeños vídeos para usarlos en tus entradas o páginas.
Páginas. A diferencia de las entradas, no tienen fecha de publicación.
Comentarios. Área en donde administras todos los comentarios que se van publicando ya sea en tu blog o en tus páginas. Los puedes editar, eliminar o mandar al spam. También puedes seleccionar si prefieres primero verlos y aprobarlos o que se publiquen automáticamente.
Información de tu tema o plantilla. Este apartado no aparece en todos los casos, más bien sólo cuando utilizas un tema “Premium” o que tiene su propio panel de opciones para modificar su estructura y diseño.
Apariencia. En esta sección puedes agregar, instalar o eliminar nuevos temas, administrar los widgets, crear y modificar menús, editar el código de los archivos de tu tema (incluyendo el CSS) y también personalizar el título y la portada estática de tu tema (la página de inicio).
Plugins. Agrega, modifica, instala o elimina nuevos plugins.
Usuarios. Aquí puedes modificar tu perfil, agregar tus links de redes sociales, cambiar tu alias, tu email e información básica. Si otras personas van a editar tu sitio o publicar contenido, en esta sección puedes crearles un perfil y definir su rol.
Herramientas. Importar y exportar son las opciones disponibles inicialmente. Si instalas ciertos plugins, su panel de opciones podría aparecer en esta sección.
Ajustes. Toda la configuración básica de tu sitio se hace en esta parte. También podrás modificar las opciones de cualquier plugin que instales en esta sección. De entrada tendrás acceso a configurar las opciones generales, de escritura, de lectura, de comentarios, de medios y de enlaces permanentes.
3.12 Multisite
WordPress suele instalarse para un solo sitio de Internet. ¿Qué hacemos si necesitamos construir un nuevo sitio de Internet en el mismo servidor?. Una opción obvia es instalar otra copia de WordPress, con su correspondientes archivos y base de datos. Otra opción es activar la facilidad multisite que permite que con una sola instalación se puedan gestionar varios sitios de Internet (que normalmente estarán relacionados, aunque no necesariamente).


OBJETOS

**Autentificación/Autorización (FINAL)**


**Herramientas y documentación para la creación de Plugins de WordPress**




```
● Arquitectura MVC en Plugins. Cómo aplicar el conocido enfoque MVC utilizado en la programación Web para el caso del
desarrollo de plugins. Lectura recomendada, escrita por Ian Dunn de Automattic.
● Generate WordPress: imprescindible para generar fragmentos de código que nos ayudan a acelerar el proceso de
desarrollo. En esta web, podemos crear Custom Post Types, Útil también para crear los readme.txt en el formato
especial que nos pide WordPress.org para subir toda la información del plugin.
● WordPress Plugin Boilerplate: La estructura de un plugin con el enfoque orientado a objeto, preparado para añadirle la
funcionalidad que queramos. Estableciendo una analogía con los Starter Themes, sería una especie de ‘Starter
WordPress Plugin’
```

**Implementando un plugin**

En el plugin de ejemplo vimos cómo crear la estructura necesaria para poner en funcionamiento varios aspectos, entre los que

destacan:

```
● Menús de administración: Cómo crear un menú o integrarlo en los menús de administración existentes, como
Entradas, Páginas, Configuración, Herramientas, etc.
● Shortcodes: Cómo crear un shortcode y los tipos de shortcodes: con o sin contenido.
● Valores de configuración: Cómo guardar y obtener de la base de datos de WordPress los valores de configuración que
tengamos definidos en nuestro plugin, a través de las funciones update_options() y get_options()
● Integrar Ajax en los formularios: Cómo usar Ajax para capturar los datos que el usuario envía desde los formularios de
configuración.
● Otros: Aunque no en detalle, también vimos la posibilidad de hacer uso de metadatos, custom post types, taxonomías,
usuarios, el cron, etc.
●
```

### Wordpres

index.php : Siempre carga el tema activo. Si estamos

autentificados carga una cabecera con nuetro menu.

$wpdb = new wpdb( DB_USER, DB_PASSWORD, DB_NAME, DB_HOST ); Base de datos wordpress

/**
* Turn register globals off.
*
* @since 2.1.
* @access private
*/
function wp_unregister_GLOBALS() {
if ( !ini_get( 'register_globals' ) )
return;

if ( isset( $_REQUEST['GLOBALS'] ) )
die( 'GLOBALS overwrite attempt detected' );

// Variables that shouldn't be unset
$no_unset = array( 'GLOBALS', '_GET', '_POST', '_COOKIE', '_REQUEST', '_SERVER', '_ENV', '_FILES', 'table_prefix' );

$input = array_merge( $_GET, $_POST, $_COOKIE, $_SERVER, $_ENV, $_FILES, isset( $_SESSION ) && is_array( $_SESSION )? $_SESSION :
array() );
foreach ( $input as $k => $v )
if ( !in_array( $k, $no_unset ) && isset( $GLOBALS[$k] ) ) {
unset( $GLOBALS[$k] );
}
}


## Configuración servidor Apache

★Configuración de Apache:

✓ http.conf

```
✓ .htaccess
(personalizado en directorios)
```
[http://httpd.apache.org/docs/2.2/es/](http://httpd.apache.org/docs/2.2/es/)

[http://php.net/manual/es/](http://php.net/manual/es/)

```
#.htaccess
Options +Indexes
RewriteEngine on
RewriteBase /Lab2017/T
RewriteRule pp/(.*)/(.*)$
phpInfo.php?Val1=$1&Val2=$
RewriteRule funcion/(.*)$ $
```


### 13. Manejo de sesiones en PHP

###### ★¿Que es una sesión?

###### ★¿Como se puede simular una

###### sesión?

###### ★Ejemplos de necesidad de uso de

###### sesiones.


★El manejo de las sesiones se realiza de la

siguiente forma:

✓Todas las páginas deben realizar una

llamada a session_start() para cargar las

variables de la sesión

✓Esta llamada debe estar colocada antes de

cualquier código HTML

✓Conviene llamar a session_destroy() para

cerrar la sesión

### Manejo de sesiones en PHP


session_start ()
Se inicializa la variable $_SESSION y le asigna un identificador de sesión único. Si la
sesión ya está iniciada, carga todas las variables de sesión.

```
$_SESSION[‘nombre’] = valor;
registra una variable de sesión
```
```
unset ($_SESSION[‘nombre’]);
elimina una variable de sesión
```
if (isset($_SESSION[‘nombre’]))
comprueba si una variable está registrada. Devuelve true en caso afirmativo y false en
caso contrario

```
session_destroy ()
cierra una sesión
```
### Manejo de sesiones en PHP


Ejercicio:

Escribe un procesar.php que muestre el formulario de la

diapositiva 39. Y si se ha rellenado el formulario guarde en la sesión el sexo

elegido y muestre de nuevo el formulario con un mensaje primero que

indique que sexo había elegido en la acción anterior.

### Manejo de sesiones en PHP


★-Diferencia entre la

primera y la n-esima vez

que se entra en esta

página.

★-¿Pasa lo mismo si se

ejecuta en el navegador

que en una terminal?

★http://dllido.al.nisu.org/

Lab_2017/T1/session.php

### Ejemplo Sesiones:

12

**<?php**

**var_dump($_COOKIE);**

**var_dump($_SESSION);**

**session_start();**

**var_dump($_SESSION);**

**var_dump($_COOKIE);**

**if (!isset($_SESSION["activo"]) )**

**{ $_SESSION["activo"] = 1;**

**$_SESSION["usuario"]="visitante";**

**}**

**else { print "bienvenido visitante\n";}**

**var_dump($_SESSION);**

**var_dump($_COOKIE);**

**?>**


### 15. Autenticación/Autorización de usuarios

★ ¿Qué es la autentificación de

usuarios?

★ ¿Qué es la autorización de

usuarios?


### Autenticación de usuarios

★Una cuestión frecuente en un sitio web es controlar el

acceso de los usuarios a una zona determinada del mismo

★Autentificación requiere credenciales o pruebas de

identidad.

★La autentificación de usuarios puede realizarse:

✓Autentificación en el Servidor: En Apache los ficheros

.htacacces

✓Autentificación en el Cliente: Firma Digital

✓Autentificación por Programa: Escribir un programa para

controlar el acceso de los usuarios.

¿Cómo sabemos si ya se han autentificado? Mediante

sesiones


Cuando el navegador solicita un recurso, el servidor comprueba la

autentificación requerida por el recurso.

Autentificación básica: Solicita al cliente un usuario y contraseña,

que viajan encriptadas con codificación base 64 bits

### Autentificación En Servidor

**GET index.html HTTP/1.**

**Authorization: Basic dfasdfasdfdf==**

```
HTTP/1.0 401 Unauthorized
WWW-Authenticate:Basic
realm='default userdb”
```
GET index.html HTTP/1.

**HTTP/1.0 200 OK**

```
Cliente Web
Servidor Web
```
```
Login
Passwd
```
c


**Autentificación Básica**

### en Servidor PHP

★Autentificación básica en servidor

-Configurar fichero .htaccess en directorio que se

requiera.

```
#./htaccess
AuthType Basic
AuthName "Password Required"
AuthUserFile /home/alxxx/privado/.htpasswd
Require valid-user
```
-Ejemplo:

[http://dllido.al.nisu.org/Lab2017/T1/Auth/session.php](http://dllido.al.nisu.org/Lab2017/T1/Auth/session.php)

```
#Generar fichero password en linux
>htpasswd -c /home/alxxx/privado/.htpasswd usuario
```

**Autentificación Básica**

#### en Servidor PHP

★Autentificación básica en php.

```
https://dllido.al.nisu.org/Lab2017/T1/basicAuth.php
<?php
```
$valid_passwords = array ("Pepe" => "Catala",”lola”=>”lola”);

```
$valid_users = array_keys($valid_passwords);
$user = $_SERVER['PHP_AUTH_USER'];
```
$pass = $_SERVER['PHP_AUTH_PW'];

$validated = (in_array($user, $valid_users)) && ($pass == $valid_passwords[$user]);

```
if (!$validated) {
header('WWW-Authenticate: Basic realm="My Realm"');
```
header('HTTP/1.0 401 Unauthorized');

die ("Not authorized");

```
}
// If arrives here, is a valid user.
```
echo "<p>Welcome $user.</p>";

echo "<p>Congratulation, you are into the system.</p>";

?>


##### Autorizar recursos

#### a los usuarios

★ Cuestiones:

✓ ¿Hay que pedir autorización a todos los recursos que se

soliciten?

✓ ¿La acción “redirect” es propia de php o del protocolo

http?

✓ ¿Qué entiendes por usuario cliente, visitante,

gestor,administrador?

✓ ¿Que podríamos hacer al cambiar el rol del usuario?


##### Acción Autentificación

#### por programa

**Datos correctos**

**Petición Autentificación**

**Mostrar formulario**

**sí**

**no**

```
Usuario Autentificado
(Datos Identificación)
```
action=logear (^) **Acción formulario**


##### Autorizar recursos

#### a los usuarios

Petición Recurso

Sesión iniciada

```
Página Defecto
sí
```
**no**

**no**

**no**

Usuario Autorizado

**sí**

Usuario Válido

Iniciar sesión

**sí**

**sí**

**Mostrar formulario**

**Acción formulario**

Devolver Recurso


##### Autorizar recursos

#### a los usuarios

21

Petición Recurso

Sesión iniciada

```
Página Defecto
sí
```
**no**

**no**

Usuario Autorizado

Usuario Válido

Iniciar sesión

**sí**

**Mostrar formulario**

**Acción formulario**

Devolver Recurso

```
no
$data[‘error’]
$central=login.phtml
```
**sí (** $_SESSION[‘rol]’==”CLIENTE” **)**

**sí (** $_SESSION[‘activo’]=1 **)**

redirect?action=loguear

$data[‘error’]
$central=login.phtml

```
$_SESSION[‘activo’]=1
$_SESSION[‘cliente’]=”XXXX”
$_SESSION[‘rol]’=”CLIENTE”
```
header('Location: [http://www.example.com/');](http://www.example.com/');)

?action=login


#### EJERCICIO

★Programa en php que requiera que el usuario tenga una

sesión activa para acceder a todos los recursos excepto a

la página principal.

★Para tener una sesión activa el usuario debe introducir el

login y passwd (?action=loguear) y verificar que es un

usuario de nuestra tabla “users” (?action=login), en cuyo

caso inicializar las variables de sesión con

$_SESSION[”action”]=1.

https://dllido.al.nisu.org/Lab2017/T1/Login/index.php


#### ¿Dudas?



This is a offline tool, your data stays locally and is not send to any server!
Feedback & Bug Reports